<!DOCTYPE html> <html lang="en-US"> <head> <meta charset="UTF-8"> <meta http-equiv="X-UA-Compatible" content="IE=Edge"> <link rel="stylesheet" href="/assets/css/just-the-docs-default.css"> <link rel="stylesheet" href="/assets/css/just-the-docs-head-nav.css" id="jtd-head-nav-stylesheet"> <style id="jtd-nav-activation"> .site-nav > ul.nav-list:first-child > li > a, .site-nav > ul.nav-list:first-child > li > ul > li > a, .site-nav > ul.nav-list:first-child > li > ul > li > ul > li:not(:nth-child(1)) > a { background-image: none; } .site-nav > ul.nav-list:not(:first-child) a, .site-nav li.external a { background-image: none; } .site-nav > ul.nav-list:first-child > li:nth-child(2) > ul > li:nth-child(5) > ul > li:nth-child(1) > a { font-weight: 600; text-decoration: none; }.site-nav > ul.nav-list:first-child > li:nth-child(2) > button svg, .site-nav > ul.nav-list:first-child > li:nth-child(2) > ul > li:nth-child(5) > button svg { transform: rotate(-90deg); }.site-nav > ul.nav-list:first-child > li.nav-list-item:nth-child(2) > ul.nav-list, .site-nav > ul.nav-list:first-child > li.nav-list-item:nth-child(2) > ul.nav-list > li.nav-list-item:nth-child(5) > ul.nav-list { display: block; } </style> <script async src="https://www.googletagmanager.com/gtag/js?id=G-W6M7DSFF4B"></script> <script> window.dataLayer = window.dataLayer || []; function gtag(){dataLayer.push(arguments);} gtag('js', new Date()); gtag('config', 'G-W6M7DSFF4B', { 'anonymize_ip': true }); </script> <script src="/assets/js/vendor/lunr.min.js"></script> <script src="/assets/js/just-the-docs.js"></script> <meta name="viewport" content="width=device-width, initial-scale=1"> <link rel="icon" href="/favicon.ico" type="image/x-icon"> <!-- Begin Jekyll SEO tag v2.8.0 --> <title>Snapshots | Eventualize</title> <meta name="generator" content="Jekyll v4.3.2" /> <meta property="og:title" content="Snapshots" /> <meta property="og:locale" content="en_US" /> <meta name="description" content="A simple &amp; powerful event sourcing framework" /> <meta property="og:description" content="A simple &amp; powerful event sourcing framework" /> <link rel="canonical" href="http://localhost:4000/learn-more/main-mechanisms/snapshots.html" /> <meta property="og:url" content="http://localhost:4000/learn-more/main-mechanisms/snapshots.html" /> <meta property="og:site_name" content="Eventualize" /> <meta property="og:type" content="website" /> <meta name="twitter:card" content="summary" /> <meta property="twitter:title" content="Snapshots" /> <script type="application/ld+json"> {"@context":"https://schema.org","@type":"WebPage","description":"A simple &amp; powerful event sourcing framework","headline":"Snapshots","publisher":{"@type":"Organization","logo":{"@type":"ImageObject","url":"http://localhost:4000/images/dark-theme-logo-horizontal.png"}},"url":"http://localhost:4000/learn-more/main-mechanisms/snapshots.html"}</script> <!-- End Jekyll SEO tag --> </head> <body> <a class="skip-to-main" href="#main-content">Skip to main content</a> <svg xmlns="http://www.w3.org/2000/svg" class="d-none"> <symbol id="svg-link" viewBox="0 0 24 24"> <title>Link</title> <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather feather-link"> <path d="M10 13a5 5 0 0 0 7.54.54l3-3a5 5 0 0 0-7.07-7.07l-1.72 1.71"></path><path d="M14 11a5 5 0 0 0-7.54-.54l-3 3a5 5 0 0 0 7.07 7.07l1.71-1.71"></path> </svg> </symbol> <symbol id="svg-menu" viewBox="0 0 24 24"> <title>Menu</title> <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather feather-menu"> <line x1="3" y1="12" x2="21" y2="12"></line><line x1="3" y1="6" x2="21" y2="6"></line><line x1="3" y1="18" x2="21" y2="18"></line> </svg> </symbol> <symbol id="svg-arrow-right" viewBox="0 0 24 24"> <title>Expand</title> <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather feather-chevron-right"> <polyline points="9 18 15 12 9 6"></polyline> </svg> </symbol> <!-- Feather. MIT License: https://github.com/feathericons/feather/blob/master/LICENSE --> <symbol id="svg-external-link" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather feather-external-link"> <title id="svg-external-link-title">(external link)</title> <path d="M18 13v6a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2V8a2 2 0 0 1 2-2h6"></path><polyline points="15 3 21 3 21 9"></polyline><line x1="10" y1="14" x2="21" y2="3"></line> </symbol> <symbol id="svg-doc" viewBox="0 0 24 24"> <title>Document</title> <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather feather-file"> <path d="M13 2H6a2 2 0 0 0-2 2v16a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2V9z"></path><polyline points="13 2 13 9 20 9"></polyline> </svg> </symbol> <symbol id="svg-search" viewBox="0 0 24 24"> <title>Search</title> <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather feather-search"> <circle cx="11" cy="11" r="8"></circle><line x1="21" y1="21" x2="16.65" y2="16.65"></line> </svg> </symbol> <!-- Bootstrap Icons. MIT License: https://github.com/twbs/icons/blob/main/LICENSE.md --> <symbol id="svg-copy" viewBox="0 0 16 16"> <title>Copy</title> <svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" fill="currentColor" class="bi bi-clipboard" viewBox="0 0 16 16"> <path d="M4 1.5H3a2 2 0 0 0-2 2V14a2 2 0 0 0 2 2h10a2 2 0 0 0 2-2V3.5a2 2 0 0 0-2-2h-1v1h1a1 1 0 0 1 1 1V14a1 1 0 0 1-1 1H3a1 1 0 0 1-1-1V3.5a1 1 0 0 1 1-1h1v-1z"/> <path d="M9.5 1a.5.5 0 0 1 .5.5v1a.5.5 0 0 1-.5.5h-3a.5.5 0 0 1-.5-.5v-1a.5.5 0 0 1 .5-.5h3zm-3-1A1.5 1.5 0 0 0 5 1.5v1A1.5 1.5 0 0 0 6.5 4h3A1.5 1.5 0 0 0 11 2.5v-1A1.5 1.5 0 0 0 9.5 0h-3z"/> </svg> </symbol> <symbol id="svg-copied" viewBox="0 0 16 16"> <title>Copied</title> <svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" fill="currentColor" class="bi bi-clipboard-check-fill" viewBox="0 0 16 16"> <path d="M6.5 0A1.5 1.5 0 0 0 5 1.5v1A1.5 1.5 0 0 0 6.5 4h3A1.5 1.5 0 0 0 11 2.5v-1A1.5 1.5 0 0 0 9.5 0h-3Zm3 1a.5.5 0 0 1 .5.5v1a.5.5 0 0 1-.5.5h-3a.5.5 0 0 1-.5-.5v-1a.5.5 0 0 1 .5-.5h3Z"/> <path d="M4 1.5H3a2 2 0 0 0-2 2V14a2 2 0 0 0 2 2h10a2 2 0 0 0 2-2V3.5a2 2 0 0 0-2-2h-1v1A2.5 2.5 0 0 1 9.5 5h-3A2.5 2.5 0 0 1 4 2.5v-1Zm6.854 7.354-3 3a.5.5 0 0 1-.708 0l-1.5-1.5a.5.5 0 0 1 .708-.708L7.5 10.793l2.646-2.647a.5.5 0 0 1 .708.708Z"/> </svg> </symbol> </svg> <div class="side-bar"> <div class="site-header" role="banner"> <a href="/" class="site-title lh-tight"> <div class="site-logo" role="img" aria-label="Eventualize"></div> </a> <button id="menu-button" class="site-button btn-reset" aria-label="Toggle menu" aria-pressed="false"> <svg viewBox="0 0 24 24" class="icon" aria-hidden="true"><use xlink:href="#svg-menu"></use></svg> </button> </div> <nav aria-label="Main" id="site-nav" class="site-nav"> <ul class="nav-list"><li class="nav-list-item"><a href="/" class="nav-list-link">Home</a></li><li class="nav-list-item"><button class="nav-list-expander btn-reset" aria-label="toggle items in Learn More category" aria-pressed="false"> <svg viewBox="0 0 24 24" aria-hidden="true"><use xlink:href="#svg-arrow-right"></use></svg> </button><a href="/learn-more/" class="nav-list-link">Learn More</a><ul class="nav-list"><li class="nav-list-item"><a href="/learn-more/why-should-i-use-it.html" class="nav-list-link">Why Should I Use It?</a></li><li class="nav-list-item"><a href="/learn-more/events.html" class="nav-list-link">Events</a></li><li class="nav-list-item"><a href="/learn-more/streams.html" class="nav-list-link">Streams</a></li><li class="nav-list-item"><a href="/learn-more/aggregates.html" class="nav-list-link">Aggregates</a></li><li class="nav-list-item"><button class="nav-list-expander btn-reset" aria-label="toggle items in Main Mechanisms category" aria-pressed="false"> <svg viewBox="0 0 24 24" aria-hidden="true"><use xlink:href="#svg-arrow-right"></use></svg> </button><a href="/learn-more/main-mechanisms/main-mechanisms.html" class="nav-list-link">Main Mechanisms</a><ul class="nav-list"><li class="nav-list-item"> <a href="/learn-more/main-mechanisms/snapshots.html" class="nav-list-link">Snapshots</a> </li><li class="nav-list-item"> <a href="/learn-more/main-mechanisms/occ.html" class="nav-list-link">Optimistic Concurrency Control (OCC)</a> </li></ul></li></ul></li><li class="nav-list-item"><a href="/quick-start.html" class="nav-list-link">Quick Start</a></li><li class="nav-list-item"><button class="nav-list-expander btn-reset" aria-label="toggle items in Contribution category" aria-pressed="false"> <svg viewBox="0 0 24 24" aria-hidden="true"><use xlink:href="#svg-arrow-right"></use></svg> </button><a href="/contribution/" class="nav-list-link">Contribution</a><ul class="nav-list"><li class="nav-list-item"><a href="/contribution/code-contribution.html" class="nav-list-link">Code Contribution</a></li></ul></li></ul> </nav> </div> <div class="main" id="top"> <div id="main-header" class="main-header"> <div class="search" role="search"> <div class="search-input-wrap"> <input type="text" id="search-input" class="search-input" tabindex="0" placeholder="Search Eventualize" aria-label="Search Eventualize" autocomplete="off"> <label for="search-input" class="search-label"><svg viewBox="0 0 24 24" class="search-icon"><use xlink:href="#svg-search"></use></svg></label> </div> <div id="search-results" class="search-results"></div> </div> <a class="site-button" href="https://github.com/outsidenote/eventualize" style="display: flex;flex-direction: row;"> <div style="height: 100%; width:30px;display:flex;align-items: center;"> <div style="object-fit: contain;"><img src="/images/github-logo.png" height="60"></div> </div> <small style="height:100%;display: flex;align-items: center;margin-left: 5px;">View on GitHub</small> </a> </div> <div class="main-content-wrap"> <nav aria-label="Breadcrumb" class="breadcrumb-nav"> <ol class="breadcrumb-nav-list"> <li class="breadcrumb-nav-list-item"><a href="/learn-more/">Learn More</a></li> <li class="breadcrumb-nav-list-item"><a href="/learn-more/main-mechanisms/main-mechanisms.html">Main Mechanisms</a></li> <li class="breadcrumb-nav-list-item"><span>Snapshots</span></li> </ol> </nav> <div id="main-content" class="main-content"> <main> <h1 id="snapshots"> <a href="#snapshots" class="anchor-heading" aria-labelledby="snapshots"><svg viewBox="0 0 16 16" aria-hidden="true"><use xlink:href="#svg-link"></use></svg></a> Snapshots </h1> <p>The purpose of a <strong>Snapshot</strong> is accelarating getting an Aggregate’s state. It does so by optimizing the excution of the <strong>FoldingLogic</strong>. In essense, a Snapshot is a calculated state that is based on a specific Folding Logic. Whenever events are starting to pile up within an Aggregate, a Snpashot is created. So the next time this aggregate is fetched, the state already exist with no required calculations. If more events are stored since the moment the Snapshot was created, only they are folded unto the the Snapshot’s state.</p> <p>For example, The aggregate of the user “john” holds 1,000 events: <img src="../../images/aggregate-with-1k-events-example.png" width="500" /></p> <p>Scanning and folding all these events might take too much time, which can be unreasonable for some use cases. Let’s see what happens when we introduce a Snapshot for the calculating “total points”: <img src="../../images/aggregate-with-snapshot-example.png" width="900" /></p> <p>As you can see, a Snapshot is like another type of aggregate.<br /> The difference is, that it stores the state across different points in time for a cpecific folding logic of a particular aggregate.<br /> In our example, the snapshot stores the different states of folding logic “Total Points” for the user “john” aggregate.<br /></p> <p>The latest state the Snapshot holds is up to event 990.<br /> That means it is missing the last 10 events.</p> <p>Let’s see how <code class="language-plaintext highlighter-rouge">Eventualize</code> would fetch the “Total Points” for the user “john” now: <img src="../../images/fetch-with-snapshot-example.png" width="900" /></p> <h2 id="when-does-a-snapshot-get-created"> <a href="#when-does-a-snapshot-get-created" class="anchor-heading" aria-labelledby="when-does-a-snapshot-get-created"><svg viewBox="0 0 16 16" aria-hidden="true"><use xlink:href="#svg-link"></use></svg></a> When does a Snapshot get created? </h2> <p>Every aggregate has a specification of <code class="language-plaintext highlighter-rouge">maximum events between snapshots</code>. When event are stored and the latest snapshot is more than this specification’s number of events - the state of the aggregate is stored as a new snapshot, that is relevant up to the latest event that is now being stored.</p> </main> </div> </div> <div class="search-overlay"></div> </div> <script src="https://cdn.jsdelivr.net/npm/mermaid@9.1.3/dist/mermaid.min.js"></script> <script> var config = { "securityLevel": 'loose', "theme": 'dark', };; mermaid.initialize(config); window.mermaid.init(undefined, document.querySelectorAll('.language-mermaid')); </script> </body> </html>
